name: Manual job to trigger
on:
  workflow_dispatch:
    inputs:
      appEnvironment:
        description: 'Environment'
        required: true
        default: 'qa'
        type: choice
        options:
        - qa
        - pro

      releaseType:
        description: 'Release type'
        required: true
        default: 'minor'
        type: choice
        options:
        - major
        - minor
        - patch

      
      isOnlyDatabase:
        description: 'Only update database'
        required: false
        type: boolean
      
        # pro feature
      # environment:
      #   description: 'Environment to run tests against'
      #   type: environment
      #   required: true

jobs:
  qa-job:
    if: ${{ inputs.appEnvironment == 'qa' }}
    runs-on: [self-hosted]
    container: node:lts
    steps:
      - name: qa step
        run: echo "iam on production $RELEASE_TYPE"
  
  pro-job:
    if: ${{ inputs.appEnvironment == 'pro' }}
    runs-on: [self-hosted]
    container: node:lts
    steps:
      - name: production step
        run: echo "iam on production $RELEASE_TYPE"


  log-the-inputs:
    runs-on: [self-hosted]
    container: node:lts
    steps:
      - run: |
          echo "Release Type: $RELEASE_TYPE"
          echo "Only database: $ONLY_DATABASE"
          echo "Environment: $ENVIRONMENT"
        env:
          RELEASE_TYPE: ${{ inputs.releaseType }}
          ENVIRONMENT: ${{ inputs.appEnvironment }}
          ONLY_DATABASE: ${{ inputs.isOnlyDatabase }}